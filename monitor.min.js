!function(e){function t(n){if(o[n])return o[n].exports;var a=o[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var o={};t.m=e,t.c=o,t.d=function(e,o,n){t.o(e,o)||Object.defineProperty(e,o,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(o,"a",o),o},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t){!function(e){function t(){this.handleLogInfo=function(e,t){var o=localStorage[e]?localStorage[e]:"";switch(e){case T:localStorage[T]=o+JSON.stringify(t)+"$$$";break;case U:localStorage[U]=o+JSON.stringify(t)+"$$$";break;case N:localStorage[N]=o+JSON.stringify(t)+"$$$";break;case L:localStorage[L]=o+JSON.stringify(t)+"$$$";break;case O:localStorage[O]=o+JSON.stringify(t)+"$$$"}}}function o(){this.happenTime=(new Date).getTime(),this.webMonitorId=v,this.simpleUrl=e.location.href.split("?")[0].replace("#",""),this.completeUrl=encodeURIComponent(e.location.href),this.customerKey=P.getCustomerKey();var t=localStorage.wmUserInfo?JSON.parse(localStorage.wmUserInfo):"";this.userId=P.b64EncodeUnicode(t.userId||"0"),this.firstUserParam=P.b64EncodeUnicode(t.firstUserParam||"0"),this.secondUserParam=P.b64EncodeUnicode(t.secondUserParam||"0")}function n(e,t,n){o.apply(this),this.uploadType=e,this.pageKey=P.getPageKey(),this.deviceName=C.deviceName,this.os=C.os+(C.osVersion?" "+C.osVersion:""),this.browserName=C.browserName,this.browserVersion=C.browserVersion,this.monitorIp="",this.country="china",this.province="",this.city="",this.loadType=t,this.loadTime=n}function a(e,t,n,a,i,r,s){o.apply(this),this.uploadType=e,this.behaviorType=t,this.className=P.b64EncodeUnicode(n),this.placeholder=P.b64EncodeUnicode(a),this.inputValue=P.b64EncodeUnicode(i),this.tagName=r,this.innerText=P.b64EncodeUnicode(encodeURIComponent(s))}function i(e,t,n){o.apply(this),this.uploadType=e,this.pageKey=P.getPageKey(),this.deviceName=C.deviceName,this.os=C.os+(C.osVersion?" "+C.osVersion:""),this.browserName=C.browserName,this.browserVersion=C.browserVersion,this.monitorIp="",this.country="china",this.province="",this.city="",this.errorMessage=P.b64EncodeUnicode(t),this.errorStack=P.b64EncodeUnicode(n),this.browserInfo=I}function r(e,t,n,a,i,r){o.apply(this),this.uploadType=e,this.httpUrl=P.b64EncodeUnicode(t),this.status=n,this.statusText=a,this.statusResult=i,this.happenTime=r}function s(e,t,n){o.apply(this),this.uploadType=e,this.description=P.b64EncodeUnicode(t),this.screenInfo=n}function c(){var t=e.location.href.split("?")[0].replace("#","");m!=t&&(l(),m=t)}function l(){P.setPageKey();const e=new n(O,"none",0);e.handleLogInfo(O,e)}function d(){function t(e,t,o,n,a){c();var r=e||"",s=a||"",l="";if(-1==r.toLowerCase().indexOf("script error")){r&&(l=JSON.stringify(s).split(": ")[0].replace('"',""));var d=new i(U,l+": "+r,s);d.handleLogInfo(U,d),setTimeout(function(){-1==g.indexOf(r)&&(g.push(r),P.screenShot(document.body,r))},500)}}var o=console.error;console.error=function(){var e=arguments[0]&&arguments[0].message,n=x,a=arguments[0]&&arguments[0].stack;return a||(a=arguments[0]),!f&&t(e,n,0,0,a),o.apply(console,arguments)},e.onerror=function(e,o,n,a,i){f=!0,t(e,o,n,a,i?i.stack:null)}}function u(){function t(t){var o=new CustomEvent(t,{detail:this});e.dispatchEvent(o)}function o(){var e=new n;return e.addEventListener("abort",function(){t.call(this,"ajaxAbort")},!1),e.addEventListener("error",function(){t.call(this,"ajaxError")},!1),e.addEventListener("load",function(){t.call(this,"ajaxLoad")},!1),e.addEventListener("loadstart",function(){t.call(this,"ajaxLoadStart")},!1),e.addEventListener("progress",function(){t.call(this,"ajaxProgress")},!1),e.addEventListener("timeout",function(){t.call(this,"ajaxTimeout")},!1),e.addEventListener("loadend",function(){t.call(this,"ajaxLoadEnd")},!1),e.addEventListener("readystatechange",function(){t.call(this,"ajaxReadyStateChange")},!1),e}var n=e.XMLHttpRequest;e.XMLHttpRequest=o,e.addEventListener("ajaxLoadStart",function(e){var t=(new Date).getTime();setTimeout(function(){var o=e.detail.responseURL,n=e.detail.status,a=e.detail.statusText;if(o&&-1==o.indexOf(b)){var i=new r(N,o,n,a,"发起请求",t);i.handleLogInfo(N,i)}},2e3)}),e.addEventListener("ajaxLoadEnd",function(e){var t=(new Date).getTime(),o=e.detail.responseURL,n=e.detail.status,a=e.detail.statusText;if(o&&-1==o.indexOf(b)){var i=new r(N,o,n,a,"请求返回",t);i.handleLogInfo(N,i)}})}function p(e){e&&e.record&&1==e.record&&(c(),document.onclick=function(e){var t="",o="",n="",i=e.target.tagName,r="";"svg"!=e.target.tagName&&"use"!=e.target.tagName&&(t=e.target.className,o=e.target.placeholder||"",n=e.target.value||"",r=e.target.innerText.replace(/\s*/g,""),r.length>200&&(r=r.substring(0,100)+"... ..."+r.substring(r.length-99,r.length-1)),r=r.replace(/\s/g,""));var s=new a(T,"click",t,o,n,i,r);s.handleLogInfo(T,s)})}function h(){this.getUuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})},this.getCustomerKey=function(){var e=this.getUuid();return localStorage.monitorCustomerKey||(localStorage.monitorCustomerKey=e),localStorage.monitorCustomerKey},this.getPageKey=function(){var e=this.getUuid();return localStorage.monitorPageKey||(localStorage.monitorPageKey=e),localStorage.monitorPageKey},this.setPageKey=function(){localStorage.monitorPageKey=this.getUuid()},this.ajax=function(t,o,n,a,i){var r=e.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");r.open(t,o,!0),r.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),r.onreadystatechange=function(){if(4==r.readyState&&200==r.status){var e=JSON.parse(r.responseText);"function"==typeof a&&a(e)}else"function"==typeof i&&i()},r.send("data="+JSON.stringify(n))},this.screenShot=function(t,o){var n=t,a=n.offsetWidth,i=n.offsetHeight,r=document.createElement("canvas");r.style.display="none",r.width=.3*a,r.height=.3*i,r.getContext("2d").scale(.3,.3);var c={scale:.3,canvas:r,logging:!1,width:a,height:i,useCORS:!0};e.html2canvas&&e.html2canvas(t,c).then(function(e){var t=e.toDataURL("image/webp"),n=t.replace("data:image/webp;base64,",""),a=P.b64EncodeUnicode(n),i=new s(L,o,a);i.handleLogInfo(L,i)})},this.getDevice=function(){var t={},o=navigator.userAgent,n=o.match(/(Android);?[\s\/]+([\d.]+)?/),a=o.match(/(iPad).*OS\s([\d_]+)/),i=o.match(/(iPod)(.*OS\s([\d_]+))?/),r=!a&&o.match(/(iPhone\sOS)\s([\d_]+)/),s=o.match(/Android\s[\S\s]+Build\//);if(t.ios=t.android=t.iphone=t.ipad=t.androidChrome=!1,t.isWeixin=/MicroMessenger/i.test(o),t.os="web",t.deviceName="PC",n&&(t.os="android",t.osVersion=n[2],t.android=!0,t.androidChrome=o.toLowerCase().indexOf("chrome")>=0),(a||r||i)&&(t.os="ios",t.ios=!0),r&&!i&&(t.osVersion=r[2].replace(/_/g,"."),t.iphone=!0),a&&(t.osVersion=a[2].replace(/_/g,"."),t.ipad=!0),i&&(t.osVersion=i[3]?i[3].replace(/_/g,"."):null,t.iphone=!0),t.ios&&t.osVersion&&o.indexOf("Version/")>=0&&"10"===t.osVersion.split(".")[0]&&(t.osVersion=o.toLowerCase().split("version/")[1].split(" ")[0]),t.iphone){t.deviceName="iphone";var c=e.screen.width,l=e.screen.height;320===c&&480===l?t.deviceName="iphone 4":320===c&&568===l?t.deviceName="iphone 5/SE":375===c&&667===l?t.deviceName="iphone 6/7/8":414===c&&736===l?t.deviceName="iphone 6/7/8 Plus":375===c&&812===l&&(t.deviceName="iphone X")}else if(t.ipad)t.deviceName="ipad";else if(s){var d=s[0],u=d.split(";")[1].replace(/Build\//g,"");t.deviceName=u.replace(/(^\s*)|(\s*$)/g,"")}if(-1==o.indexOf("Mobile")){var p=navigator.userAgent.toLowerCase(),h=/msie [\d.]+;/gi,f=/firefox\/[\d.]+/gi,g=/chrome\/[\d.]+/gi,m=/safari\/[\d.]+/gi;if(t.browserName="未知",p.indexOf("msie")>0){var v=p.match(h)[0];t.browserName=v.split("/")[0],t.browserVersion=v.split("/")[1]}if(p.indexOf("firefox")>0){var v=p.match(f)[0];t.browserName=v.split("/")[0],t.browserVersion=v.split("/")[1]}if(p.indexOf("safari")>0&&p.indexOf("chrome")<0){var v=p.match(m)[0];t.browserName=v.split("/")[0],t.browserVersion=v.split("/")[1]}if(p.indexOf("chrome")>0){var v=p.match(g)[0];t.browserName=v.split("/")[0],t.browserVersion=v.split("/")[1]}}return t.webView=(r||a||i)&&o.match(/.*AppleWebKit(?!.*Safari)/i),t},this.loadJs=function(e,t){var o=document.createElement("script");o.async=1,o.src=e,o.onload=t;var n=document.getElementsByTagName("script")[0];return n.parentNode.insertBefore(o,n),n},this.b64EncodeUnicode=function(e){try{return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(e,t){return String.fromCharCode("0x"+t)}))}catch(t){return e}}}localStorage||(e.localStorage=new Object),localStorage.wmUserInfo="";var f=!1,g=[],m=e.location.href.split("?")[0].replace("#",""),v="omega_webmonitor",w=-1===e.location.href.indexOf("https")?"http://":"https://",x=e.location.href,y=-1==x.indexOf("localhost")?w+"www.webfunny.cn":w+"localhost:8010",b="/api/v1/upLg",S=y+"/api/v1/upLg",E=y+"",O="CUSTOMER_PV",N="HTTP_LOG",U="JS_ERROR",L="SCREEN_SHOT",T="ELE_BEHAVIOR",I=e.navigator.userAgent,P=new h,C=P.getDevice();localStorage.wmUserInfo&&JSON.parse(localStorage.wmUserInfo);n.prototype=new t,a.prototype=new t,i.prototype=new t,r.prototype=new t,s.prototype=new t,function(){l(),p({record:1}),d(),u();var e=0;setInterval(function(){if(c(),e>=25){var t=(localStorage[T]||"")+(localStorage[U]||"")+(localStorage[N]||"")+(localStorage[L]||"")+(localStorage[O]||"");t&&(localStorage[T]="",localStorage[U]="",localStorage[N]="",localStorage[L]="",localStorage[O]="",P.ajax("POST",S,{logInfo:t},function(e){},function(){})),e=0}e++},200)}(),e.webfunny={wm_upload:function(t,o,n,a){var i=(new Date).toString(),r={createTime:encodeURIComponent(i),happenTime:(new Date).getTime(),uploadType:"WM_UPLOAD",simpleUrl:encodeURIComponent(t),webMonitorId:v,recordType:o,recordIndex:n,description:a},s=E,c=e.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");c.open("POST",s,!0),c.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),c.send("data="+JSON.stringify([r]))},wm_init_user:function(e,t,o){e||console.warn("userId 初始化值为0(不推荐) 或者 未初始化"),t||console.warn("firstParam 初始化值为0(不推荐) 或者 未初始化"),o||console.warn("secondParam 初始化值为0(不推荐) 或者 未初始化"),localStorage.wmUserInfo=JSON.stringify({userId:e,firstUserParam:t,secondUserParam:o})},wm_screen_shot:function(e){setTimeout(function(){P.screenShot(document.body,e)},500)}},function(){function t(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var o=document.createEvent("CustomEvent");return o.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),o}if("function"==typeof e.CustomEvent)return!1;t.prototype=e.Event.prototype,e.CustomEvent=t}()}(window)}]);