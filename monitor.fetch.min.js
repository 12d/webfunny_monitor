!function(e){function t(o){if(r[o])return r[o].exports;var n=r[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var r={};t.m=e,t.c=r,t.d=function(e,r,o){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,r){r(1),e.exports=r(2)},function(e,t){function r(){this.guid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})}}function o(){var e=new r;localStorage.customerKey||(localStorage.customerKey=e.guid());var t=document.getElementById("webmonitor");t&&(l=t.getAttribute("monitor"));var o=-1!=p.indexOf("localhost")?u+"localhost:8001":u+"www.webfunny.cn";return{CUSTOMER_KEY:localStorage.customerKey,WEB_MONITOR_ID:l,BROWSER_INFO:window.navigator.userAgent,WEB_MONITOR_IGNORE_URL:o+"/server/common/uploadLogInfo",HTTP_UPLOAD_URI:o,HTTP_UPLOAD_RECORD_DATA:"",HTTP_UPLOAD_LOG_INFO:"/server/common/uploadLogInfo"}}function n(){function e(e){var t=new CustomEvent(e,{detail:this});window.dispatchEvent(t)}function t(){var t=new R;return t.addEventListener("abort",function(){e.call(this,"ajaxAbort")},!1),t.addEventListener("error",function(){e.call(this,"ajaxError")},!1),t.addEventListener("load",function(){e.call(this,"ajaxLoad")},!1),t.addEventListener("loadstart",function(){e.call(this,"ajaxLoadStart")},!1),t.addEventListener("progress",function(){e.call(this,"ajaxProgress")},!1),t.addEventListener("timeout",function(){e.call(this,"ajaxTimeout")},!1),t.addEventListener("loadend",function(){e.call(this,"ajaxLoadEnd")},!1),t.addEventListener("readystatechange",function(){e.call(this,"ajaxReadyStateChange")},!1),t}try{var r=new o,n=new s,c=new d,u="",y="",w=!1,b=!1;i("POST",r.HTTP_UPLOAD_URI+"/server/project/getProject",{webMonitorId:l},function(e){if(0===e.status){var t=e.data.project;if(!t||!t.recording||1!=t.recording)return void(b=!1);t&&t.recordBehavior&&1==t.recordBehavior&&(document.onclick=function(e){var t=p,o=e.target.className?e.target.className.replace(/\s/g,""):"",n=encodeURIComponent(e.target.placeholder||""),i=encodeURIComponent(e.target.value||""),a=e.target.tagName,s=encodeURIComponent(e.target.innerText);s.length>200&&(s=s.substring(0,200)+"..."),s=s.replace(/\s/g,"");var c={happenTime:(new Date).getTime(),uploadType:"ELE_BEHAVIOR",behaviorType:"click",webMonitorId:r.WEB_MONITOR_ID,customerKey:r.CUSTOMER_KEY,simpleUrl:t,className:o,placeholder:n,inputValue:i,tagName:a,innerText:s};g("ELE_BEHAVIOR",c)}),y=t.filterType,u=t.filterDomain,"include"===y&&-1!=p.indexOf(u)?b=!0:"exclude"===y&&-1==p.indexOf(u)&&(b=!0)}else console.log("未获取到项目信息")});var T=function(){h=setTimeout(function(){v(),clearTimeout(h),h=null},5e3)},g=function(e,t){if(f="",localStorage.webMonitorUploadMessageArray?localStorage.webMonitorUploadMessageArray=localStorage.webMonitorUploadMessageArray+JSON.stringify(t)+"$$$":localStorage.webMonitorUploadMessageArray=JSON.stringify(t)+"$$$",m=localStorage.webMonitorUploadMessageArray.split("$$$"),m=m.slice(0,m.length-1),m.length<30)return void(h||T());h&&(clearTimeout(h),h=null),v()},v=function(){if(m.length&&b){localStorage.webMonitorUploadMessageArray="";for(var e=0;e<m.length;e++){var t=localStorage.wmInitUser?JSON.parse(localStorage.wmInitUser):{},o=JSON.parse(m[e].replace(/undefined\{/g,"{"));o.customerKey=r.CUSTOMER_KEY,o.userId=t.userId||"",o.userName=t.userName||"",o.userType=t.userType||"",m[e]=o}i("POST",r.HTTP_UPLOAD_URI+"/server/common/uploadLogInfo",m,function(){m=new Array})}},_=function(e,t,o,n,i){var a=e||"",s=t||p,d=i||"",l=s&&s.split("?")[0],u=(new Date).toString(),f={happenTime:(new Date).getTime(),createTime:encodeURIComponent(u),uploadType:encodeURIComponent("JS_ERROR"),projectName:encodeURIComponent(""),simpleUrl:encodeURIComponent(l),location:encodeURIComponent(p),errorMessage:encodeURIComponent(a),errorStack:d,browserInfo:r.BROWSER_INFO,platformType:c.os||"web",webMonitorId:r.WEB_MONITOR_ID};g("JS_ERROR",f)};a(n);var O=console.error;console.error=function(){var e=arguments[0]&&arguments[0].message,t=p,r=arguments[0]&&arguments[0].stack;return r||(r=arguments[0]),!w&&_(e,t,0,0,r),O.apply(console,arguments)},window.onerror=function(e,t,r,o,n){var i=n?n.stack:null;w=!0,_(e,t,0,0,i)};var R=window.XMLHttpRequest,I=[];window.XMLHttpRequest=t,window.addEventListener("ajaxReadyStateChange",function(e){if(!e.detail.responseURL){var t={timeStamp:(new Date).getTime(),event:e};I.push(t)}}),window.addEventListener("ajaxLoadEnd",function(e){for(var t=0;t<I.length;t++)if(200==I[t].event.detail.status){var o=I[t].event.detail.responseURL,n=""+((new Date).getTime()-I[t].timeStamp)/1e3,i=(new Date).toString(),a=p,s=a&&a.split("?")[0],c={uploadType:encodeURIComponent("HTTP_LOG"),happenTime:(new Date).getTime(),createTime:encodeURIComponent(i),loadTime:encodeURIComponent(n),httpUrl:encodeURIComponent(o),location:encodeURIComponent(a),simpleUrl:s,webMonitorId:r.WEB_MONITOR_ID,customerKey:r.CUSTOMER_KEY};if(!o||-1!=o.indexOf(r.WEB_MONITOR_IGNORE_URL))continue;g("HTTP_LOG",c),I.splice(t,1)}}),window.addEventListener("ajaxError",function(e){var t=null,o=p;if(e._args){if(t="abort"===e._args[2]?"abort":"timeout"===e._args[2]?"timeout":e._args[0].status,f=e._args[1].url,f||(f=e.detail.responseURL),-1!=f.indexOf(r.WEB_MONITOR_IGNORE_URL))return}else t="offline";var n=(new Date).toString(),i={uploadType:encodeURIComponent("HTTP_ERROR"),happenTime:(new Date).getTime(),createTime:encodeURIComponent(n),httpStatus:encodeURIComponent(t),httpUrl:encodeURIComponent(f),location:encodeURIComponent(o),webMonitorId:r.WEB_MONITOR_ID};g("HTTP_ERROR",i)})}catch(e){console.error(e,"上报信息无法解析")}}function i(e,t,r,o,n){var i=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");i.open(e,t,!0),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.onreadystatechange=function(){if(4==i.readyState&&200==i.status){var e=JSON.parse(i.responseText);"function"==typeof o&&o(e)}else"function"==typeof n&&n()},i.send("data="+JSON.stringify(r))}function a(e){var t=new r,n=new o,a=new d,s=window.location.href.split("?")[0].replace("#",""),c=t.guid(),l=(new Date).getTime(),u=(new Date).toString(),p={uploadType:"SCAN_TIME",happenTime:l,createTime:encodeURIComponent(u),customerKey:n.CUSTOMER_KEY,pageKey:c,webMonitorId:n.WEB_MONITOR_ID,simpleUrl:s,location:s,country:"中国",province:"",city:"",monitorIp:"",platform:a.os||"web",platformVersion:a.osVersion||"",deviceName:a.deviceName||"",browserName:a.browserName||"",browserVersion:a.browserVersion||"",loadType:"none",loadTime:0},f=localStorage.wmInitUser?JSON.parse(localStorage.wmInitUser):{},h=n.HTTP_UPLOAD_URI+n.HTTP_UPLOAD_LOG_INFO;if(p.customerKey=n.CUSTOMER_KEY,p.userId=f.userId||"",p.userName=f.userName||"",p.userType=f.userType||"",localStorage.monitorAddress){var m=localStorage.monitorAddress.split("$$$");p.province=m[0]||"",p.monitorIp=m[1]||"",i("POST",h,[p],function(){})}else setTimeout(function(){if(localStorage.monitorAddress){var e=localStorage.monitorAddress.split("$$$");p.province=e[0]||"",p.monitorIp=e[1]||""}i("POST",h,[p],function(){})},2e3);setInterval(function(){var e=window.location.href.split("?")[0].replace("#","");s!=e&&(u=(new Date).toString(),l=(new Date).getTime(),c=t.guid(),p.pageKey=c,p.createTime=u,p.happenTime=l,p.simpleUrl=e,p.location=e,i("POST",h,[p],function(){}),s=e)},1e3)}function s(){function e(){r=returnCitySN.cname||"",o=returnCitySN.cip||"",(r||o)&&(window.localStorage.monitorAddress=r+"$$$"+o)}var t="pv.sohu.com/cityjson?ie=utf-8",r="",o="";return function(){if(localStorage.monitorAddress){var n=localStorage.monitorAddress.split("$$$");r=n[0]||"",o=n[1]||""}else c(u+t,function(){e()})}(),{country:"中国",province:r,city:"",monitorIp:o,ipAddress:""}}function c(e,t){var r=document.createElement("script");r.async=1,r.src=e,r.onload=t;var o=document.getElementsByTagName("script")[0];return o.parentNode.insertBefore(r,o),o}function d(){var e={},t=navigator.userAgent,r=t.match(/(Android);?[\s\/]+([\d.]+)?/),o=t.match(/(iPad).*OS\s([\d_]+)/),n=t.match(/(iPod)(.*OS\s([\d_]+))?/),i=!o&&t.match(/(iPhone\sOS)\s([\d_]+)/),a=t.match(/Android\s[\S\s]+Build\//);if(e.ios=e.android=e.iphone=e.ipad=e.androidChrome=!1,e.isWeixin=/MicroMessenger/i.test(t),e.os="web",r&&(e.os="android",e.osVersion=r[2],e.android=!0,e.androidChrome=t.toLowerCase().indexOf("chrome")>=0),(o||i||n)&&(e.os="ios",e.ios=!0),i&&!n&&(e.osVersion=i[2].replace(/_/g,"."),e.iphone=!0),o&&(e.osVersion=o[2].replace(/_/g,"."),e.ipad=!0),n&&(e.osVersion=n[3]?n[3].replace(/_/g,"."):null,e.iphone=!0),e.ios&&e.osVersion&&t.indexOf("Version/")>=0&&"10"===e.osVersion.split(".")[0]&&(e.osVersion=t.toLowerCase().split("version/")[1].split(" ")[0]),e.iphone)e.deviceName="iphone";else if(e.ipad)e.deviceName="ipad";else if(a){var s=a[0],c=s.split(";")[1].replace(/Build\//g,"");e.deviceName=c.replace(/(^\s*)|(\s*$)/g,"")}if(-1==t.indexOf("Mobile")){var d=navigator.userAgent.toLowerCase(),l=/msie [\d.]+;/gi,u=/firefox\/[\d.]+/gi,p=/chrome\/[\d.]+/gi,f=/safari\/[\d.]+/gi;if(e.browserName="未知",d.indexOf("msie")>0){var h=d.match(l)[0];e.browserName=h.split("/")[0],e.browserVersion=h.split("/")[1]}if(d.indexOf("firefox")>0){var h=d.match(u)[0];e.browserName=h.split("/")[0],e.browserVersion=h.split("/")[1]}if(d.indexOf("safari")>0&&d.indexOf("chrome")<0){var h=d.match(f)[0];e.browserName=h.split("/")[0],e.browserVersion=h.split("/")[1]}if(d.indexOf("chrome")>0){var h=d.match(p)[0];e.browserName=h.split("/")[0],e.browserVersion=h.split("/")[1]}}return e.webView=(i||o||n)&&t.match(/.*AppleWebKit(?!.*Safari)/i),e}var l="jeffery_webmonitor",u=-1===window.location.href.indexOf("https")?"http://":"https://",p=window.location.href.split("?")[0].replace("#",""),f=null,h=null,m=null;localStorage||(window.localStorage=new Object),window.webfunny={wm_upload:function(e,t,r,n){var i=new o,a=(new Date).toString(),s={createTime:encodeURIComponent(a),happenTime:(new Date).getTime(),uploadType:"WM_UPLOAD",simpleUrl:encodeURIComponent(e),webMonitorId:i.WEB_MONITOR_ID,recordType:t,recordIndex:r,description:n},c=i.HTTP_UPLOAD_URI+i.HTTP_UPLOAD_RECORD_DATA,d=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");d.open("POST",c,!0),d.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),d.send("data="+JSON.stringify([s]))},wm_init_user:function(e,t,r){e||console.warn("userId 初始化值为0(不推荐) 或者 未初始化"),t||console.warn("userName 初始化值为0(不推荐) 或者 未初始化"),r||console.warn("userTpye 初始化值为0(不推荐) 或者 未初始化"),localStorage.wmInitUser=JSON.stringify({userId:e,userName:t,userType:r})}},function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var r=document.createEvent("CustomEvent");return r.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),r}if("function"==typeof window.CustomEvent)return!1;e.prototype=window.Event.prototype,window.CustomEvent=e}(),new n},function(e,t){!function(e){function t(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function r(e){return"string"!=typeof e&&(e=String(e)),e}function o(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return w.iterable&&(t[Symbol.iterator]=function(){return t}),t}function n(e){this.map={},e instanceof n?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function i(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function a(e){return new Promise(function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}})}function s(e){var t=new FileReader,r=a(t);return t.readAsArrayBuffer(e),r}function c(e){var t=new FileReader,r=a(t);return t.readAsText(e),r}function d(e){for(var t=new Uint8Array(e),r=new Array(t.length),o=0;o<t.length;o++)r[o]=String.fromCharCode(t[o]);return r.join("")}function l(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function u(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,e)if("string"==typeof e)this._bodyText=e;else if(w.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(w.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(w.searchParams&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(w.arrayBuffer&&w.blob&&T(e))this._bodyArrayBuffer=l(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!w.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(e)&&!g(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=l(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):w.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},w.blob&&(this.blob=function(){var e=i(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?i(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(s)}),this.text=function(){var e=i(this);if(e)return e;if(this._bodyBlob)return c(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(d(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},w.formData&&(this.formData=function(){return this.text().then(h)}),this.json=function(){return this.text().then(JSON.parse)},this}function p(e){var t=e.toUpperCase();return v.indexOf(t)>-1?t:e}function f(e,t){t=t||{};var r=t.body;if(e instanceof f){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new n(e.headers)),this.method=e.method,this.mode=e.mode,r||null==e._bodyInit||(r=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new n(t.headers)),this.method=p(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r)}function h(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var r=e.split("="),o=r.shift().replace(/\+/g," "),n=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(o),decodeURIComponent(n))}}),t}function m(e){var t=new n;return e.split(/\r?\n/).forEach(function(e){var r=e.split(":"),o=r.shift().trim();if(o){var n=r.join(":").trim();t.append(o,n)}}),t}function y(e,t){t||(t={}),this.type="default",this.status="status"in t?t.status:200,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new n(t.headers),this.url=t.url||"",this._initBody(e)}var w={searchParams:"URLSearchParams"in e,iterable:"Symbol"in e&&"iterator"in Symbol,blob:"FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in e,arrayBuffer:"ArrayBuffer"in e};if(w.arrayBuffer)var b=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],T=function(e){return e&&DataView.prototype.isPrototypeOf(e)},g=ArrayBuffer.isView||function(e){return e&&b.indexOf(Object.prototype.toString.call(e))>-1};n.prototype.append=function(e,o){e=t(e),o=r(o);var n=this.map[e];this.map[e]=n?n+","+o:o},n.prototype.delete=function(e){delete this.map[t(e)]},n.prototype.get=function(e){return e=t(e),this.has(e)?this.map[e]:null},n.prototype.has=function(e){return this.map.hasOwnProperty(t(e))},n.prototype.set=function(e,o){this.map[t(e)]=r(o)},n.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},n.prototype.keys=function(){var e=[];return this.forEach(function(t,r){e.push(r)}),o(e)},n.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),o(e)},n.prototype.entries=function(){var e=[];return this.forEach(function(t,r){e.push([r,t])}),o(e)},w.iterable&&(n.prototype[Symbol.iterator]=n.prototype.entries);var v=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];f.prototype.clone=function(){return new f(this,{body:this._bodyInit})},u.call(f.prototype),u.call(y.prototype),y.prototype.clone=function(){return new y(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new n(this.headers),url:this.url})},y.error=function(){var e=new y(null,{status:0,statusText:""});return e.type="error",e};var _=[301,302,303,307,308];y.redirect=function(e,t){if(-1===_.indexOf(t))throw new RangeError("Invalid status code");return new y(null,{status:t,headers:{location:e}})},e.Headers=n,e.Request=f,e.Response=y,e.fetch=function(e,t){return fetchHttpUrl=e,new Promise(function(r,o){var n=new f(e,t),i=new XMLHttpRequest;i.onload=function(){var e={status:i.status,statusText:i.statusText,headers:m(i.getAllResponseHeaders()||"")};e.url="responseURL"in i?i.responseURL:e.headers.get("X-Request-URL");var t="response"in i?i.response:i.responseText;r(new y(t,e))},i.onerror=function(){o(new TypeError("Network request failed"))},i.ontimeout=function(){o(new TypeError("Network request failed"))},i.open(n.method,n.url,!0),"include"===n.credentials&&(i.withCredentials=!0),"responseType"in i&&w.blob&&(i.responseType="blob"),n.headers.forEach(function(e,t){i.setRequestHeader(t,e)}),i.send(void 0===n._bodyInit?null:n._bodyInit)})},e.fetch.polyfill=!0}("undefined"!=typeof self?self:window)}]);