!function(e){function t(n){if(o[n])return o[n].exports;var a=o[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var o={};t.m=e,t.c=o,t.d=function(e,o,n){t.o(e,o)||Object.defineProperty(e,o,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(o,"a",o),o},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t){!function(e){function t(){this.handleLogInfo=function(e,t){var o=localStorage[e]?localStorage[e]:"";switch(e){case _:localStorage[_]=o+JSON.stringify(t)+"$$$";break;case P:localStorage[P]=o+JSON.stringify(t)+"$$$";break;case C:localStorage[C]=o+JSON.stringify(t)+"$$$";break;case R:localStorage[R]=o+JSON.stringify(t)+"$$$";break;case U:localStorage[U]=o+JSON.stringify(t)+"$$$";break;case I:localStorage[I]=o+JSON.stringify(t)+"$$$";break;case V:localStorage[V]=o+JSON.stringify(t)+"$$$"}}}function o(){this.happenTime=(new Date).getTime(),this.webMonitorId=b,this.simpleUrl=e.location.href.split("?")[0].replace("#",""),this.completeUrl=encodeURIComponent(e.location.href),this.customerKey=k.getCustomerKey();var t=localStorage.wmUserInfo?JSON.parse(localStorage.wmUserInfo):"";this.userId=k.b64EncodeUnicode(t.userId||""),this.firstUserParam=k.b64EncodeUnicode(t.firstUserParam||""),this.secondUserParam=k.b64EncodeUnicode(t.secondUserParam||"")}function n(e,t,n){o.apply(this),this.uploadType=e,this.pageKey=k.getPageKey(),this.deviceName=M.deviceName,this.os=M.os+(M.osVersion?" "+M.osVersion:""),this.browserName=M.browserName,this.browserVersion=M.browserVersion,this.monitorIp="",this.country="china",this.province="",this.city="",this.loadType=t,this.loadTime=n}function a(e,t,n,a,r,i,s,c,l,d,p,u){o.apply(this),this.uploadType=e,this.loadType=t,this.loadPage=n,this.domReady=a,this.redirect=r,this.lookupDomain=i,this.ttfb=s,this.request=c,this.loadEvent=l,this.appcache=d,this.unloadEvent=p,this.connect=u}function r(e,t,n,a,r,i,s){o.apply(this),this.uploadType=e,this.behaviorType=t,this.className=k.b64EncodeUnicode(n),this.placeholder=k.b64EncodeUnicode(a),this.inputValue=k.b64EncodeUnicode(r),this.tagName=i,this.innerText=k.b64EncodeUnicode(encodeURIComponent(s))}function i(e,t,n){o.apply(this),this.uploadType=e,this.pageKey=k.getPageKey(),this.deviceName=M.deviceName,this.os=M.os+(M.osVersion?" "+M.osVersion:""),this.browserName=M.browserName,this.browserVersion=M.browserVersion,this.monitorIp="",this.country="china",this.province="",this.city="",this.errorMessage=k.b64EncodeUnicode(t),this.errorStack=k.b64EncodeUnicode(n),this.browserInfo=$}function s(e,t,n,a,r,i,s){o.apply(this),this.uploadType=e,this.httpUrl=k.b64EncodeUnicode(t),this.status=n,this.statusText=a,this.statusResult=r,this.happenTime=i,this.loadTime=s}function c(e,t,n,a){o.apply(this),this.uploadType=e,this.description=k.b64EncodeUnicode(t),this.screenInfo=n,this.imgType=a||"jpeg"}function l(e,t,n,a){o.apply(this),this.uploadType=e,this.elementType=n,this.sourceUrl=k.b64EncodeUnicode(t),this.status=a}function d(){var t=e.location.href.split("?")[0].replace("#","");y!=t&&(p(),y=t)}function p(){k.setPageKey();var e=new n(U,"none",0);e.handleLogInfo(U,e)}function u(){k.addLoadEvent(function(){setTimeout(function(){if(S){var t="load";t=S[0]&&"navigate"===S[0].type?"load":"reload";var o=w,n=new a(I);n.loadType=t,n.loadPage=o.loadEventEnd-o.navigationStart,n.domReady=o.domComplete-o.responseEnd,n.redirect=o.redirectEnd-o.redirectStart,n.lookupDomain=o.domainLookupEnd-o.domainLookupStart,n.ttfb=o.responseStart-o.navigationStart,n.request=o.responseEnd-o.requestStart,n.loadEvent=o.loadEventEnd-o.loadEventStart,n.appcache=o.domainLookupStart-o.fetchStart,n.unloadEvent=o.unloadEventEnd-o.unloadEventStart,n.connect=o.connectEnd-o.connectStart,n.handleLogInfo(I,n)}if(e.performance&&"function"==typeof e.performance.getEntries){for(var r=e.performance.getEntries(),i=r.filter(function(e){return"script"===e.initiatorType}),s=r.filter(function(e){return"link"===e.initiatorType}),c=[],d=document.getElementsByTagName("script"),p=0;p<d.length;p++)d[p].src&&c.push(d[p].src);for(var u=c.filter(function(e){for(var t=!0,o=0;o<i.length;o++)if(i[o].name===e){t=!1;break}return t}),f=[],h=document.getElementsByTagName("link"),p=0;p<h.length;p++)h[p].href&&f.push(h[p].href);for(var g=f.filter(function(e){for(var t=!0,o=0;o<s.length;o++)if(s[o].name===e){t=!1;break}return t}),m=0;m<u.length;m++){var v=new l(V,u[m],"script","0");v.handleLogInfo(V,v)}for(var m=0;m<g.length;m++){var v=new l(V,g[m],"script","0");v.handleLogInfo(V,v)}}},1e3)})}function f(){function t(e,t,o,n,a){d();var r=e||"",s=a||"",c="";if(-1==r.toLowerCase().indexOf("script error")){r&&(c=JSON.stringify(s).split(": ")[0].replace('"',""));var l=new i(P,c+": "+r,s);l.handleLogInfo(P,l)}}var o=console.error;console.error=function(){var e=arguments[0]&&arguments[0].message,n=E,a=arguments[0]&&arguments[0].stack;return a||(a=arguments[0]),!v&&t(e,n,0,0,a),o.apply(console,arguments)},e.onerror=function(e,o,n,a,r){v=!0,t(e,o,n,a,r?r.stack:null)}}function h(){function t(t){var o=new CustomEvent(t,{detail:this});e.dispatchEvent(o)}function o(){var e=new n;return e.addEventListener("abort",function(){t.call(this,"ajaxAbort")},!1),e.addEventListener("error",function(){t.call(this,"ajaxError")},!1),e.addEventListener("load",function(){t.call(this,"ajaxLoad")},!1),e.addEventListener("loadstart",function(){t.call(this,"ajaxLoadStart")},!1),e.addEventListener("progress",function(){t.call(this,"ajaxProgress")},!1),e.addEventListener("timeout",function(){t.call(this,"ajaxTimeout")},!1),e.addEventListener("loadend",function(){t.call(this,"ajaxLoadEnd")},!1),e.addEventListener("readystatechange",function(){t.call(this,"ajaxReadyStateChange")},!1),e}var n=e.XMLHttpRequest,a=[];e.XMLHttpRequest=o,e.addEventListener("ajaxLoadStart",function(e){var t={timeStamp:(new Date).getTime(),event:e};a.push(t)}),e.addEventListener("ajaxLoadEnd",function(){for(var e=0;e<a.length;e++)if(a[e].event.detail.status>0){var t=(new Date).getTime(),o=a[e].event.detail.responseURL,n=a[e].event.detail.status,r=a[e].event.detail.statusText,i=t-a[e].timeStamp;if(!o||-1!=o.indexOf(L))return;var c=new s(C,o,n,r,"发起请求",a[e].timeStamp,0);c.handleLogInfo(C,c);var l=new s(C,o,n,r,"请求返回",t,i);l.handleLogInfo(C,l),a.splice(e,1)}})}function g(e){e&&e.record&&1==e.record&&(d(),document.onclick=function(e){var t="",o="",n="",a=e.target.tagName,i="";"svg"!=e.target.tagName&&"use"!=e.target.tagName&&(t=e.target.className,o=e.target.placeholder||"",n=e.target.value||"",i=e.target.innerText.replace(/\s*/g,""),i.length>200&&(i=i.substring(0,100)+"... ..."+i.substring(i.length-99,i.length-1)),i=i.replace(/\s/g,""));var s=new r(_,"click",t,o,n,a,i);s.handleLogInfo(_,s)})}function m(){this.getUuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})},this.getCustomerKey=function(){var e=this.getUuid();return localStorage.monitorCustomerKey||(localStorage.monitorCustomerKey=e),localStorage.monitorCustomerKey},this.getPageKey=function(){var e=this.getUuid();return localStorage.monitorPageKey||(localStorage.monitorPageKey=e),localStorage.monitorPageKey},this.setPageKey=function(){localStorage.monitorPageKey=this.getUuid()},this.addLoadEvent=function(t){var o=e.onload;"function"!=typeof e.onload?e.onload=t:e.onload=function(){o(),t()}},this.ajax=function(t,o,n,a,r){var i=e.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");i.open(t,o,!0),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.onreadystatechange=function(){if(4==i.readyState&&200==i.status){var e=JSON.parse(i.responseText);"function"==typeof a&&a(e)}else"function"==typeof r&&r()},i.send("data="+JSON.stringify(n))},this.screenShot=function(t,o){var n=t,a=n.offsetWidth,r=n.offsetHeight,i=document.createElement("canvas");i.style.display="none",i.width=.3*a,i.height=.3*r,i.getContext("2d").scale(.3,.3);var s={scale:.3,canvas:i,logging:!1,width:a,height:r,useCORS:!0};e.html2canvas&&e.html2canvas(t,s).then(function(e){var t=e.toDataURL("image/webp"),n=t.replace("data:image/webp;base64,",""),a=k.b64EncodeUnicode(n),r=new c(R,o,a);r.handleLogInfo(R,r)})},this.getDevice=function(){var t={},o=navigator.userAgent,n=o.match(/(Android);?[\s\/]+([\d.]+)?/),a=o.match(/(iPad).*OS\s([\d_]+)/),r=o.match(/(iPod)(.*OS\s([\d_]+))?/),i=!a&&o.match(/(iPhone\sOS)\s([\d_]+)/),s=o.match(/Android\s[\S\s]+Build\//);if(t.ios=t.android=t.iphone=t.ipad=t.androidChrome=!1,t.isWeixin=/MicroMessenger/i.test(o),t.os="web",t.deviceName="PC",n&&(t.os="android",t.osVersion=n[2],t.android=!0,t.androidChrome=o.toLowerCase().indexOf("chrome")>=0),(a||i||r)&&(t.os="ios",t.ios=!0),i&&!r&&(t.osVersion=i[2].replace(/_/g,"."),t.iphone=!0),a&&(t.osVersion=a[2].replace(/_/g,"."),t.ipad=!0),r&&(t.osVersion=r[3]?r[3].replace(/_/g,"."):null,t.iphone=!0),t.ios&&t.osVersion&&o.indexOf("Version/")>=0&&"10"===t.osVersion.split(".")[0]&&(t.osVersion=o.toLowerCase().split("version/")[1].split(" ")[0]),t.iphone){t.deviceName="iphone";var c=e.screen.width,l=e.screen.height;320===c&&480===l?t.deviceName="iphone 4":320===c&&568===l?t.deviceName="iphone 5/SE":375===c&&667===l?t.deviceName="iphone 6/7/8":414===c&&736===l?t.deviceName="iphone 6/7/8 Plus":375===c&&812===l&&(t.deviceName="iphone X")}else if(t.ipad)t.deviceName="ipad";else if(s){var d=s[0],p=d.split(";")[1].replace(/Build\//g,"");t.deviceName=p.replace(/(^\s*)|(\s*$)/g,"")}if(-1==o.indexOf("Mobile")){var u=navigator.userAgent.toLowerCase(),f=/msie [\d.]+;/gi,h=/firefox\/[\d.]+/gi,g=/chrome\/[\d.]+/gi,m=/safari\/[\d.]+/gi;if(t.browserName="未知",u.indexOf("msie")>0){var v=u.match(f)[0];t.browserName=v.split("/")[0],t.browserVersion=v.split("/")[1]}if(u.indexOf("firefox")>0){var v=u.match(h)[0];t.browserName=v.split("/")[0],t.browserVersion=v.split("/")[1]}if(u.indexOf("safari")>0&&u.indexOf("chrome")<0){var v=u.match(m)[0];t.browserName=v.split("/")[0],t.browserVersion=v.split("/")[1]}if(u.indexOf("chrome")>0){var v=u.match(g)[0];t.browserName=v.split("/")[0],t.browserVersion=v.split("/")[1]}}return t.webView=(i||a||r)&&o.match(/.*AppleWebKit(?!.*Safari)/i),t},this.loadJs=function(e,t){var o=document.createElement("script");o.async=1,o.src=e,o.onload=t;var n=document.getElementsByTagName("script")[0];return n.parentNode.insertBefore(o,n),n},this.b64EncodeUnicode=function(e){try{return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(e,t){return String.fromCharCode("0x"+t)}))}catch(t){return e}}}localStorage||(e.localStorage=new Object),localStorage.wmUserInfo="";var v=!1,y=e.location.href.split("?")[0].replace("#",""),w=performance&&performance.timing,S=function(){return performance&&"function"==typeof performance.getEntries?performance.getEntries():null}(),b="default_webmonitor",x=-1===e.location.href.indexOf("https")?"http://":"https://",E=e.location.href,T=-1==E.indexOf("localhost")?x+"www.webfunny.cn":x+"localhost:8010",L="/api/v1/upLg",N=T+"/api/v1/upLg",O=T+"",U="CUSTOMER_PV",I="LOAD_PAGE",C="HTTP_LOG",P="JS_ERROR",R="SCREEN_SHOT",_="ELE_BEHAVIOR",V="RESOURCE_LOAD",$=e.navigator.userAgent,k=new m,M=k.getDevice();localStorage.wmUserInfo&&JSON.parse(localStorage.wmUserInfo);n.prototype=new t,a.prototype=new t,r.prototype=new t,i.prototype=new t,s.prototype=new t,c.prototype=new t,l.prototype=new t,function(){try{p(),u(),g({record:1}),f(),h();var e=0;setInterval(function(){if(d(),e>=25){var t=(localStorage[_]||"")+(localStorage[P]||"")+(localStorage[C]||"")+(localStorage[R]||"")+(localStorage[U]||"")+(localStorage[I]||"")+(localStorage[V]||"");t&&(localStorage[_]="",localStorage[P]="",localStorage[C]="",localStorage[R]="",localStorage[U]="",localStorage[I]="",localStorage[V]="",k.ajax("POST",N,{logInfo:t},function(e){},function(){})),e=0}e++},200)}catch(e){console.error("监控代码异常，捕获",e)}}(),e.webfunny={wm_upload:function(t,o,n,a){var r=(new Date).toString(),i={createTime:encodeURIComponent(r),happenTime:(new Date).getTime(),uploadType:"WM_UPLOAD",simpleUrl:encodeURIComponent(t),webMonitorId:b,recordType:o,recordIndex:n,description:a},s=O,c=e.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");c.open("POST",s,!0),c.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),c.send("data="+JSON.stringify([i]))},wm_init_user:function(e,t,o){return e||console.warn("userId 初始化值为0(不推荐) 或者 未初始化"),t||console.warn("userTag 初始化值为0(不推荐) 或者 未初始化"),o||console.warn("secondParam 初始化值为0(不推荐) 或者 未初始化"),t&&(b=t+"_webmonitor"),localStorage.wmUserInfo=JSON.stringify({userId:e,userTag:t,secondUserParam:o}),"1"},wm_screen_shot:function(e){setTimeout(function(){k.screenShot(document.body,e)},500)},wm_upload_picture:function(e,t){var o=new c(R,t,e,imgType);o.handleLogInfo(R,o)}},function(){function t(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var o=document.createEvent("CustomEvent");return o.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),o}if("function"==typeof e.CustomEvent)return!1;t.prototype=e.Event.prototype,e.CustomEvent=t}()}(window)}]);